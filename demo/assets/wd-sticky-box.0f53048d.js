import{d as e,r as t,N as s,v as o,h as a,j as l,o as i,c as u,w as n,a as v,n as d,x as r,u as c,z as p,i as f,y as h,a4 as b,S as y,Q as w}from"./index-80b9692c.js";import{_ as g}from"./wd-resize.065433f8.js";import{g as m,i as x,j as $,y as _,v as k,C as z,k as C,b as T}from"./page-wraper.b0527d79.js";const I=T(e({name:"wd-sticky",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"},props:{...m,zIndex:x(1),offsetTop:x(0)},setup(e,{expose:y}){const w=e,m=t(`wd-sticky${$()}`),x=t(!1),T=t("absolute"),I=t(0),R=t(0),j=t(0),P=t([]),M=t(""),N=s("box-height",null)||t(0),S=s("observerForChild",null),{proxy:E}=h(),F=h(),G=o((()=>{const e={"z-index":w.zIndex,height:_(R.value),width:_(j.value)};return x.value||(e.position="relative"),`${k(e)};${w.customStyle}`})),V=o((()=>{const e={"z-index":w.zIndex,height:_(R.value),width:_(j.value)};return x.value||(e.position="relative"),`${k(e)};`})),B=o((()=>{const e={position:T.value,top:_(I.value)};return k(e)})),H=o((()=>{let e=0;return e=44,44+w.offsetTop}));function Q(e){j.value=e.width,R.value=e.height,z((()=>{!function(){if(0===R.value&&0===j.value)return;const e=H.value+R.value;(function(){for(;0!==P.value.length;)P.value.pop().disconnect()})(),function(){const e=b(F);return P.value.push(e),e}().relativeToViewport({top:-e}).observe(`#${m.value}`,(e=>{q(e)})),C(`#${m.value}`,!1,E).then((t=>{Number(t.bottom)<=e&&q({boundingClientRect:t})}))}(),S&&S(E)}))}function q({boundingClientRect:e}){if(S&&R.value>=N.value)return T.value="absolute",void(I.value=0);e.top<=H.value?(M.value="sticky",x.value=!1,T.value="fixed",I.value=H.value):e.top>H.value&&(M.value="normal",x.value=!1,T.value="absolute",I.value=0)}return y({setPosition:function(e,t,s){x.value=e,T.value=t,I.value=s},openBox:x,position:T,top:I,height:R,width:j,state:M,offsetTop:H.value}),(e,t)=>{const s=a(l("wd-resize"),g),o=f;return i(),u(o,{style:r(`${c(G)};display: inline-block;`)},{default:n((()=>[v(o,{class:d(`wd-sticky ${e.customClass}`),style:r(c(V)),id:m.value},{default:n((()=>[v(o,{class:"wd-sticky__container",style:r(c(B))},{default:n((()=>[v(s,{onResize:Q,"custom-style":"display: inline-block;"},{default:n((()=>[p(e.$slots,"default",{},void 0,!0)])),_:3})])),_:3},8,["style"])])),_:3},8,["class","style","id"])])),_:3},8,["style"])}}}),[["__scopeId","data-v-51b3671e"]]),R=T(e({name:"wd-sticky-box",options:{addGlobalClass:!0,styleIsolation:"shared"},props:m,setup(e){const s=e,o=t(`wd-sticky-box${$()}`),c=t(new Map),m=t(0),x=t(0),_=[],{proxy:k}=h(),z=h();function T(e){x.value=e.width,m.value=e.height;const t=c.value;c.value=new Map;for(const[s]of t){I(_.find((e=>e.$.uid===s)))}t.forEach((e=>{e.disconnect()})),t.clear()}function I(e){_.find((t=>t.$.uid===e.$.uid))||_.push(e),function(e){const t=c.value.get(e.$.uid);t&&(t.disconnect(),c.value.delete(e.$.uid))}(e);const t=function(e){const t=b(z);return c.value.set(e.$.uid,t),t}(e),s=e.$.exposed,a=s.height.value+s.offsetTop;m.value<=s.height.value&&s.setPosition(!1,"absolute",0),t.relativeToViewport({top:-a}).observe(`#${o.value}`,(e=>{R(s,e)})),C(`#${o.value}`,!1,k).then((e=>{Number(e.bottom)<=a&&R(s,{boundingClientRect:e})})).catch((e=>{console.log(e)}))}function R(e,{boundingClientRect:t}){const s=e.height.value+e.offsetTop;if(t.bottom<=s)e.setPosition(!0,"absolute",t.height-e.height.value);else if(t.top<=s&&t.bottom>s){if("normal"===e.state.value)return;e.setPosition(!1,"fixed",e.offsetTop)}}return y("box-height",m),y("box-width",x),y("observerForChild",I),w((()=>{c.value=new Map})),(e,t)=>{const c=a(l("wd-resize"),g),h=f;return i(),u(h,{style:{position:"relative"}},{default:n((()=>[v(h,{class:d(`wd-sticky-box ${s.customClass}`),style:r(e.customStyle),id:o.value},{default:n((()=>[v(c,{onResize:T},{default:n((()=>[p(e.$slots,"default",{},void 0,!0)])),_:3})])),_:3},8,["class","style","id"])])),_:3})}}}),[["__scopeId","data-v-8c6a0857"]]);export{I as _,R as a};
